# Feature 0001: Audio Channel Manipulation and Effects with Tone.js

## Description
Enhance the existing voice cloning application to enable users to manipulate generated speech by splitting audio into left and right channels, adjusting channel volumes independently, and applying effects (reverb/delay) to each channel separately using Tone.js audio processing framework.

## Current Implementation Analysis
- TTS audio generation via ElevenLabs API returns MP3 blob
- Audio playback uses standard HTML5 `<audio>` element
- Frontend: React with Tanstack Query for state management
- Backend: Next.js API routes for voice cloning and TTS

## Technical Requirements

### Phase 1: Core Audio Infrastructure
**Files to modify/create:**
- `package.json` - Add Tone.js dependency
- `app/components/AudioPlayer.tsx` - New component to replace HTML5 audio element
- `app/hooks/useAudioProcessing.ts` - Custom hook for audio state management

**Algorithm Implementation:**
1. Initialize Tone.js context on audio generation
2. Create stereo input source from TTS blob URL
3. Split source into separate left/right channel processors
4. Implement gain controls for each channel independently
5. Add effect processors (reverb, delay) per channel
6. Connect processed signals to master output

### Phase 2: UI Controls Implementation
**Files to modify:**
- `app/page.tsx` - Replace audio element and add control panel
- `app/components/AudioControls.tsx` - Volume sliders and effect controls
- `app/components/ChannelPanel.tsx` - Individual channel configuration UI

**UI Components:**
1. Channel volume sliders (left/right): range 0-200%
2. Effect toggles with intensity controls
3. Preset configurations (mono, stereo, surround simulation)
4. Real-time audio visualization (optional)

### Phase 3: Enhanced Audio Features  
**Files to create/modify:**
- `app/utils/audioPresets.ts` - Predefined channel configurations
- `app/components/AudioVisualizer.tsx` - Spectrum analyzer visualization
- `app/api/audio/effects.ts` - Server-side audio processing (if needed)

**Advanced Features:**
1. Real-time effect parameter modulation
2. Audio export with applied effects
3. Channel balancing automation
4. Spatial audio positioning

## Specific Tone.js Implementation Details

### Core Audio Chain Setup:
```typescript
// Channel splitting and processing
input → splitter → [leftChannel → leftGain → leftEffects] → merge → output
                → [rightChannel → rightGain → rightEffects]
```

### Key Tone.js Classes Used:
- `Tone.Player` - Audio source playback
- `Tone.ChannelSplitter` - Stereo channel separation  
- `Tone.Gain` - Volume control per channel
- `Tone.Reverb` - Reverberation effects
- `Tone.PingPongDelay` - Stereo delay effects
- `Tone.Merge` - Final output combining

### Effect Implementation:
- **Reverb**: Room size 0.1-10s, wet/dry mix 0-1
- **Delay**: Delay time 0.1-2s, feedback 0-0.9, dry/wet mix 0-1
- **Panning**: Per-channel stereo position -1 to 1
- **EQ**: Basic frequency filtering per channel

## Data Flow Architecture
1. TTS mutation returns blob URL (existing)
2. AudioPlayer component initializes Tone.js context
3. Creates processing chain with user-configured parameters
4. Real-time parameter updates via React state
5. Effects applied during audio playback

## Integration Points
- Existing TTS mutation in `app/page.tsx` provides audio blob
- React Query for state management compatibility
- No backend changes required - all processing client-side
- Maintain existing authentication and voice management
